-- Insert Multiple Sales Data
-- This script inserts sales from various customers and invoices

-- Step 1: Insert all Sales records first
INSERT INTO [dbo].[Sale] 
    ([SaleNumber], [SaleDate], [CustomerName], [CustomerPhone], [Total], [Notes], [IsDeleted], [CreatedDate], [CreatedBy])
VALUES 
    ('IN160595', '2025-11-13', 'HEALTH REGION B', NULL, 18201.60, 'HEMOGLOBIN METER', 0, GETDATE(), 1),
    ('IN159875', '2025-10-24', 'HEALTH REGION B', NULL, 55169.16, 'Multiple items', 0, GETDATE(), 1),
    ('IN160109', '2025-11-01', 'HEALTH REGION B', NULL, 44843.48, 'GLUCOSE TEST STRIPS', 0, GETDATE(), 1),
    ('IN160128', '2025-11-01', 'HEALTH REGION B', NULL, 34132.61, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN160552', '2025-11-12', 'HEALTH REGION B', NULL, 68265.22, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN160562', '2025-11-12', 'HEALTH REGION B', NULL, 68265.22, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN160119', '2025-11-01', 'MEDICAL SUPPLY DEPOT TRANSITO -IN', NULL, 134530.43, 'GLUCOSE TEST STRIPS', 0, GETDATE(), 1),
    ('IN160505', '2025-11-11', 'MEDICAL SUPPLY DEPOT TRANSITO -IN', NULL, 89686.96, 'GLUCOSE TEST STRIPS', 0, GETDATE(), 1),
    ('IN160560', '2025-11-12', 'MEDICAL SUPPLY DEPOT TRANSITO -IN', NULL, 67265.22, 'GLUCOSE TEST STRIPS', 0, GETDATE(), 1),
    ('IN160561', '2025-11-12', 'MEDICAL SUPPLY DEPOT TRANSITO -IN', NULL, 53812.17, 'GLUCOSE TEST STRIPS', 0, GETDATE(), 1),
    ('IN160330', '2025-11-05', 'DEPARTMENT OF HEALTH MPUMALANGA', NULL, 134529.00, 'Multiple items', 0, GETDATE(), 1),
    ('IN160511', '2025-11-11', 'DEPARTMENT OF HEALTH MPUMALANGA', NULL, 0.00, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN160510', '2025-11-11', 'DEPARTMENT OF HEALTH MPUMALANGA', NULL, 313901.00, 'GLUCOSE TEST STRIPS', 0, GETDATE(), 1),
    ('IN160508', '2025-11-11', 'MP HEALTH EVANDER HOSPITAL', NULL, 8191.83, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN160538', '2025-11-12', 'MP HEALTH HQ', NULL, 4325046.86, 'HEMOGLOBIN METER & TEST STRIPS', 0, GETDATE(), 1),
    ('IN160537', '2025-11-12', 'MP HEALTH HQ', NULL, 4120756.52, 'GLUCOSE METER & TEST STRIPS', 0, GETDATE(), 1),
    ('IN160039', '2025-10-31', 'MP HEALTH TINTSWALO HOSPITAL', NULL, 35337.83, 'Multiple items', 0, GETDATE(), 1),
    ('IN160130', '2025-11-01', 'MP HEALTH TINTSWALO HOSPITAL', NULL, 41804.35, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN160216', '2025-11-03', 'MP HEALTH TINTSWALO HOSPITAL', NULL, 7122.36, 'HEMOGLOBIN METER', 0, GETDATE(), 1),
    ('IN160550', '2025-11-12', 'MP HEALTH TINTSWALO HOSPITAL', NULL, 4869.56, 'DISPOSABLE LANCETS', 0, GETDATE(), 1);

-- Step 2: Insert Sale Items
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    -- IN160595: HEMOGLOBIN METER (ID 11 for NDOH35002)
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160595'), 11, 46, 395.69, 18201.60, 0),
    
    -- IN159875: Multiple items
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159875'), 13, 100, 139.35, 13934.78, 0),    -- NDOH35003: HEMOGLOBIN TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159875'), 2, 1000, 44.84, 44843.48, 0),     -- NDOH35017: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159875'), 16, 10, 400.68, 4006.78, 0),      -- NDOH35019: KETONE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159875'), 17, 10, 275.47, 2754.35, 0),      -- NDOH35020: URIC ACID TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159875'), 4, 50, 688.56, 34428.26, 0),      -- NDOH35021: CHOLESTEROL TEST STRIPS
    
    -- IN160109: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160109'), 2, 1000, 44.84, 44843.48, 0),
    
    -- IN160128: GLUCOSE METER (ID 12 for NDOH35004)
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160128'), 12, 250, 136.53, 34132.61, 0),
    
    -- IN160552: GLUCOSE METER
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160552'), 12, 500, 136.53, 68265.22, 0),
    
    -- IN160562: GLUCOSE METER
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160562'), 12, 500, 136.53, 68265.22, 0),
    
    -- IN160119: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160119'), 2, 3000, 44.84, 134530.43, 0),
    
    -- IN160505: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160505'), 2, 2000, 44.84, 89686.96, 0),
    
    -- IN160560: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160560'), 2, 1500, 44.84, 67265.22, 0),
    
    -- IN160561: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160561'), 2, 1200, 44.84, 53812.17, 0),
    
    -- IN160330: GLUCOSE METER & TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160330'), 12, 150, 136.53, 0.00, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160330'), 2, 3000, 44.84, 134529.00, 0),
    
    -- IN160511: GLUCOSE METER
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160511'), 12, 500, 136.53, 0.00, 0),
    
    -- IN160510: GLUCOSE TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160510'), 2, 7000, 44.84, 313901.00, 0),
    
    -- IN160508: GLUCOSE METER
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160508'), 12, 60, 136.53, 8191.83, 0),
    
    -- IN160538: HEMOGLOBIN METER & TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160538'), 11, 6000, 395.69, 2374121.74, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160538'), 13, 14000, 139.35, 1950869.56, 0),
    
    -- IN160537: GLUCOSE METER & TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160537'), 12, 20000, 136.53, 2730608.69, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160537'), 2, 31000, 44.84, 1390147.83, 0),
    
    -- IN160039: Multiple items
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160039'), 12, 250, 136.53, 34132.61, 0),      -- GLUCOSE METER
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160039'), 9, 50, 24.10, 1205.22, 0),          -- QUALITY CONTROL SOLUTIONS
    
    -- IN160130: HEMOGLOBIN TEST STRIPS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160130'), 13, 300, 139.35, 41804.35, 0),
    
    -- IN160216: HEMOGLOBIN METER
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160216'), 11, 18, 395.69, 7122.36, 0),
    
    -- IN160550: DISPOSABLE LANCETS
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN160550'), 10, 10000, 0.49, 4869.56, 0);

-- Verify all sales were created
SELECT 'Total Sales Created:' AS Status, COUNT(DISTINCT SaleNumber) AS Count FROM [dbo].[Sale] 
WHERE SaleNumber IN ('IN160595','IN159875','IN160109','IN160128','IN160552','IN160562','IN160119','IN160505','IN160560','IN160561','IN160330','IN160511','IN160510','IN160508','IN160538','IN160537','IN160039','IN160130','IN160216','IN160550');

SELECT 'Total Sale Items Added:' AS Status, COUNT(*) AS Count FROM [dbo].[SaleItem] si
WHERE si.SaleId IN (SELECT Id FROM [dbo].[Sale] 
WHERE SaleNumber IN ('IN160595','IN159875','IN160109','IN160128','IN160552','IN160562','IN160119','IN160505','IN160560','IN160561','IN160330','IN160511','IN160510','IN160508','IN160538','IN160537','IN160039','IN160130','IN160216','IN160550'));

-- Summary by invoice
SELECT s.SaleNumber, s.CustomerName, s.SaleDate, s.Total, COUNT(si.Id) AS ItemCount
FROM [dbo].[Sale] s
LEFT JOIN [dbo].[SaleItem] si ON s.Id = si.SaleId
WHERE s.SaleNumber IN ('IN160595','IN159875','IN160109','IN160128','IN160552','IN160562','IN160119','IN160505','IN160560','IN160561','IN160330','IN160511','IN160510','IN160508','IN160538','IN160537','IN160039','IN160130','IN160216','IN160550')
GROUP BY s.Id, s.SaleNumber, s.CustomerName, s.SaleDate, s.Total
ORDER BY s.SaleDate, s.SaleNumber;
