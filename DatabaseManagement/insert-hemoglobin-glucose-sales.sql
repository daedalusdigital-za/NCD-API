-- Insert Hemoglobin and Glucose Meter Sales Data
-- Organized by Invoice Number

-- Step 1: Insert all Sales records by Invoice
INSERT INTO [dbo].[Sale] 
    ([SaleNumber], [SaleDate], [CustomerName], [CustomerPhone], [Total], [Notes], [IsDeleted], [CreatedDate], [CreatedBy])
VALUES 
    ('IN157362', '2025-08-25', 'FS HEALTH THABO MOFUTSANYANA DISTRICT', NULL, 111478.26, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN159154', '2025-10-03', 'FS HEALTH THABO MOFUTSANYANA DISTRICT', NULL, 69673.92, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN158233', '2025-09-09', 'DINGHA SAMA', NULL, 13934.78, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN157361', '2025-08-25', 'BHEKI MLANGENI DISTRICT HOSPITAL', NULL, 13934.79, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN154843', '2025-06-26', 'SOUTH RAND HOSPITAL', NULL, 6967.39, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN158963', '2025-09-26', 'SOUTH RAND HOSPITAL', NULL, 27869.56, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN156803', '2025-08-13', 'HELEN JOSEPH HOSPITAL', NULL, 557.39, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN159057', '2025-10-01', 'TSHWANE REHABILITATION CENTRE', NULL, 1114.78, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN157237', '2025-08-21', 'WESTONARIA SUB DISTRICT', NULL, 20902.18, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN158373', '2025-09-11', 'WESTONARIA SUB DISTRICT', NULL, 257654.13, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN155119', '2025-07-03', 'HEALTH TSHWANE REGION C', NULL, 195086.96, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN156877', '2025-08-14', 'HEALTH TSHWANE REGION C', NULL, 780347.83, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN156410', '2025-08-01', 'MP HEALTH AMAJUBA HOSPITAL', NULL, 3483.70, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN156409', '2025-08-01', 'MP HEALTH WITBANK HOSPITAL', NULL, 4180.44, 'HEMOGLOBIN TEST STRIPS', 0, GETDATE(), 1),
    ('IN159234', '2025-10-07', 'DEPARTMENT OF HEALTH AMAJUBA DISTRICT', NULL, 1365.30, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN158069', '2025-09-04', 'LADYSMITH REGIONAL HOSPITAL', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN155884', '2025-07-23', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 13653.04, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN155885', '2025-07-23', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 4095.91, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN155984', '2025-07-24', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 40959.13, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156075', '2025-07-25', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 20479.56, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156076', '2025-07-25', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 4095.91, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156186', '2025-07-29', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156612', '2025-08-06', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 1365.30, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156613', '2025-08-06', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 13653.04, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156614', '2025-08-06', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 20479.56, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156677', '2025-08-08', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 34132.61, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156678', '2025-08-08', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 13653.04, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156734', '2025-08-12', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 2730.61, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156735', '2025-08-12', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156736', '2025-08-12', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 27306.09, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156737', '2025-08-12', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 27306.09, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156753', '2025-08-12', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 54612.17, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156835', '2025-08-13', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 4778.56, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156838', '2025-08-13', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 1365.30, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156850', '2025-08-14', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 13653.04, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156851', '2025-08-14', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156982', '2025-08-18', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 27306.09, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156983', '2025-08-18', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156984', '2025-08-18', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN156985', '2025-08-18', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6826.52, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN157133', '2025-08-19', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 9557.13, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN157134', '2025-08-19', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 6007.34, 'GLUCOSE METER', 0, GETDATE(), 1),
    ('IN157199', '2025-08-20', 'PROVINCIAL PHARM SUPPLY DEPOT', NULL, 13653.04, 'GLUCOSE METER', 0, GETDATE(), 1);

-- Step 2: Insert Sale Items (41 invoices total)
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    -- Hemoglobin Test Strips (ID 13)
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157362'), 13, 800, 139.35, 111478.26, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159154'), 13, 500, 139.35, 69673.92, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158233'), 13, 100, 139.35, 13934.78, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157361'), 13, 100, 139.35, 13934.79, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN154843'), 13, 50, 139.35, 6967.39, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158963'), 13, 200, 139.35, 27869.56, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156803'), 13, 4, 139.35, 557.39, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159057'), 13, 8, 139.35, 1114.78, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157237'), 13, 150, 139.35, 20902.18, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158373'), 13, 1849, 139.35, 257654.13, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN155119'), 13, 1400, 139.35, 195086.96, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156877'), 13, 5600, 139.35, 780347.83, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156410'), 13, 25, 139.35, 3483.70, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156409'), 13, 30, 139.35, 4180.44, 0),
    
    -- Glucose Meter (ID 12)
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159234'), 12, 10, 136.53, 1365.30, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158069'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN155884'), 12, 100, 136.53, 13653.04, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN155885'), 12, 30, 136.53, 4095.91, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN155984'), 12, 300, 136.53, 40959.13, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156075'), 12, 150, 136.53, 20479.56, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156076'), 12, 30, 136.53, 4095.91, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156186'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156612'), 12, 10, 136.53, 1365.30, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156613'), 12, 100, 136.53, 13653.04, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156614'), 12, 150, 136.53, 20479.56, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156677'), 12, 250, 136.53, 34132.61, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156678'), 12, 100, 136.53, 13653.04, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156734'), 12, 20, 136.53, 2730.61, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156735'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156736'), 12, 200, 136.53, 27306.09, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156737'), 12, 200, 136.53, 27306.09, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156753'), 12, 400, 136.53, 54612.17, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156835'), 12, 35, 136.53, 4778.56, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156838'), 12, 10, 136.53, 1365.30, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156850'), 12, 100, 136.53, 13653.04, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156851'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156982'), 12, 200, 136.53, 27306.09, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156983'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156984'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156985'), 12, 50, 136.53, 6826.52, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157133'), 12, 70, 136.53, 9557.13, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157134'), 12, 44, 136.53, 6007.34, 0),
    ((SELECT Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157199'), 12, 100, 136.53, 13653.04, 0);

-- Verify
SELECT 'New Sales Created:' AS Status, COUNT(DISTINCT SaleNumber) AS Count 
FROM [dbo].[Sale] 
WHERE SaleNumber IN ('IN157362','IN159154','IN158233','IN157361','IN154843','IN158963','IN156803','IN159057','IN157237','IN158373','IN155119','IN156877','IN156410','IN156409','IN159234','IN158069','IN155884','IN155885','IN155984','IN156075','IN156076','IN156186','IN156612','IN156613','IN156614','IN156677','IN156678','IN156734','IN156735','IN156736','IN156737','IN156753','IN156835','IN156838','IN156850','IN156851','IN156982','IN156983','IN156984','IN156985','IN157133','IN157134','IN157199');

SELECT 'Total Sale Items Added:' AS Status, COUNT(*) AS Count 
FROM [dbo].[SaleItem] si
WHERE si.SaleId IN (SELECT Id FROM [dbo].[Sale] 
WHERE SaleNumber IN ('IN157362','IN159154','IN158233','IN157361','IN154843','IN158963','IN156803','IN159057','IN157237','IN158373','IN155119','IN156877','IN156410','IN156409','IN159234','IN158069','IN155884','IN155885','IN155984','IN156075','IN156076','IN156186','IN156612','IN156613','IN156614','IN156677','IN156678','IN156734','IN156735','IN156736','IN156737','IN156753','IN156835','IN156838','IN156850','IN156851','IN156982','IN156983','IN156984','IN156985','IN157133','IN157134','IN157199'));

-- Grand Total
SELECT SUM(Total) AS GrandTotal FROM [dbo].[Sale] 
WHERE SaleNumber IN ('IN157362','IN159154','IN158233','IN157361','IN154843','IN158963','IN156803','IN159057','IN157237','IN158373','IN155119','IN156877','IN156410','IN156409','IN159234','IN158069','IN155884','IN155885','IN155984','IN156075','IN156076','IN156186','IN156612','IN156613','IN156614','IN156677','IN156678','IN156734','IN156735','IN156736','IN156737','IN156753','IN156835','IN156838','IN156850','IN156851','IN156982','IN156983','IN156984','IN156985','IN157133','IN157134','IN157199');
