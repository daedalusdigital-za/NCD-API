-- Insert Sale Items for Other Products (Multiparameter, Dual Meter, Accessories)
-- Run this AFTER insert-glucose-meter-batch2-items-part1.sql

-- First check that InventoryItem IDs exist
SELECT [Id], [SKU], [Name] FROM [dbo].[InventoryItem] 
WHERE [SKU] IN ('NDOH35005','NDOH35006','NDOH35013','NDOH35014','NDOH35015','NDOH35016');

-- Store IDs in variables for reference
DECLARE @ID_MULTIPARAMETER INT = (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005');
DECLARE @ID_DUAL_METER INT = (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006');
DECLARE @ID_HB_BATTERY INT = (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35013');
DECLARE @ID_HB_QC INT = (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35014');
DECLARE @ID_LANCET INT = (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35015');
DECLARE @ID_GLUCOSE_BATTERY INT = (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35016');

-- Print IDs
SELECT 'NDOH35005 (Multiparameter)' AS Product, @ID_MULTIPARAMETER AS InventoryItemId
UNION ALL SELECT 'NDOH35006 (Dual Meter)', @ID_DUAL_METER
UNION ALL SELECT 'NDOH35013 (HB Battery)', @ID_HB_BATTERY
UNION ALL SELECT 'NDOH35014 (HB QC)', @ID_HB_QC
UNION ALL SELECT 'NDOH35015 (Lancet)', @ID_LANCET
UNION ALL SELECT 'NDOH35016 (Glucose Battery)', @ID_GLUCOSE_BATTERY;

-- MULTIPARAMETER - TAIDOC (using SKU lookup since ID may vary)
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158144' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 1, 607.10, 607.10, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159272' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 6, 517.36, 3104.14, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156882' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 1, 517.36, 517.36, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158578' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 16, 527.91, 8446.61, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158374' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 15, 527.91, 7918.69, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158735' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 10, 527.91, 5279.13, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158798' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35005'), 10, 527.91, 5279.13, 0);

-- DUAL GLUCOSE & HBA1C METER - BIOHERMES
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN154625' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 2, 2198.25, 4396.49, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156073' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 2, 2198.25, 4396.49, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156891' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 2, 2198.25, 4396.49, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159152' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 3, 2198.24, 6594.73, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158145' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 1, 2527.98, 2527.98, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157728' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 9, 2198.24, 19784.19, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159194' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 11, 2198.24, 24180.68, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158578' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 32, 2198.24, 70343.79, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158376' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 20, 2198.24, 43964.87, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158691' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 26, 2198.24, 57154.33, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157264' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 140, 2198.24, 307754.09, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159268' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 31, 2198.24, 68145.55, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159236' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 30, 2198.24, 65947.30, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158813' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 14, 2198.24, 30775.41, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159093' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35006'), 5, 2198.24, 10991.22, 0);

-- HEMOGLOBIN METER - BATTERY
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157362' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35013'), 150, 9.16, 1373.48, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159154' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35013'), 100, 9.16, 915.65, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN154843' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35013'), 50, 9.16, 457.83, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN158578' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35013'), 80, 9.16, 732.52, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156410' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35013'), 10, 9.16, 91.56, 0);

-- HEMOGLOBIN METER - QUALITY CONTROL SOLUTIONS
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157362' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35014'), 11, 120.50, 1325.55, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159154' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35014'), 11, 120.50, 1325.55, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN154843' ORDER BY Id DESC), 
     (SELECT [Id] FROM [dbo].[InventoryItem] WHERE [SKU] = 'NDOH35014'), 10, 120.50, 1205.04, 0);

-- HEMOGLOBIN METER - SINGLE USE DISPOSABLE LANCET (ID 10 = NDOH35015)
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN157362' ORDER BY Id DESC), 10, 500, 0.49, 243.48, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN159464' ORDER BY Id DESC), 10, 500, 0.49, 243.48, 0);

-- Additional items for MP HEALTH invoices - Glucose Meter (already exist, adding Hb strip items)
INSERT INTO [dbo].[SaleItem]
    ([SaleId], [InventoryItemId], [Quantity], [UnitPrice], [TotalPrice], [IsDeleted])
VALUES 
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156410' ORDER BY Id DESC), 12, 50, 136.53, 6826.52, 0),
    ((SELECT TOP 1 Id FROM [dbo].[Sale] WHERE SaleNumber = 'IN156409' ORDER BY Id DESC), 12, 28, 136.53, 3822.85, 0);

-- VERIFICATION QUERIES
SELECT 'Multiparameter Items:' AS Status, COUNT(*) AS Count 
FROM [dbo].[SaleItem] si
JOIN [dbo].[InventoryItem] ii ON si.InventoryItemId = ii.Id
WHERE ii.SKU = 'NDOH35005';

SELECT 'Dual Meter Items:' AS Status, COUNT(*) AS Count 
FROM [dbo].[SaleItem] si
JOIN [dbo].[InventoryItem] ii ON si.InventoryItemId = ii.Id
WHERE ii.SKU = 'NDOH35006';

SELECT 'HB Battery Items:' AS Status, COUNT(*) AS Count 
FROM [dbo].[SaleItem] si
JOIN [dbo].[InventoryItem] ii ON si.InventoryItemId = ii.Id
WHERE ii.SKU = 'NDOH35013';

SELECT 'HB QC Items:' AS Status, COUNT(*) AS Count 
FROM [dbo].[SaleItem] si
JOIN [dbo].[InventoryItem] ii ON si.InventoryItemId = ii.Id
WHERE ii.SKU = 'NDOH35014';

SELECT 'Lancet Items (ID 10):' AS Status, COUNT(*) AS Count 
FROM [dbo].[SaleItem] WHERE InventoryItemId = 10;

-- Grand Summary
SELECT 'Total Sales in Batch 2:' AS Status, COUNT(*) AS Count FROM [dbo].[Sale]
WHERE SaleNumber IN ('IN157235','IN157271','IN157272','IN157273','IN157323','IN157324','IN157325','IN157370','IN157480',
'IN157722','IN157723','IN157724','IN157794','IN157947','IN158030','IN158031','IN158032','IN158062','IN158065','IN158151',
'IN158153','IN158157','IN158159','IN158226','IN158227','IN158235','IN158237','IN158238','IN158239','IN158240','IN158241',
'IN158242','IN158243','IN158244','IN158251','IN158451','IN158928','IN159310','IN159311','IN159312','IN159314','IN159315',
'IN159317','IN159319','IN159320','IN159323','IN159324','IN159326','IN159327','IN159329','IN159465','CN103214','IN159555',
'IN157328','IN154160','IN156572','IN157895','IN157897','IN156936','IN152428','IN153152','IN153185','IN156476','IN156530',
'IN156531','IN156845','IN157919','IN157920','IN157923','IN157924','IN157925','IN157927','IN157929','IN157933','IN158371',
'IN158572','IN158654','IN153718','IN158144','IN157482','IN156532','IN155219','IN156529','IN156846','IN156533','IN156844',
'IN156443','IN157932','IN156500','IN156934','IN153141','IN155213','IN156576','IN157873','IN155982','IN157868','IN156585',
'IN157887','IN156786','IN155928','IN157867','IN158250','IN155222','IN156579','IN157871','IN158881','IN159233','IN158882',
'IN155215','IN157360','IN155212','IN156787','IN157876','IN158370','IN155216','IN156573','IN156586','CN103079','CN103080',
'IN156729','IN156950','IN157262','IN155218','IN156582','IN157872','IN156581','IN156804','IN156843','IN156977','IN154817',
'IN155211','IN156501','IN156987','IN158880','IN158578','IN158879','IN156802','IN157890','IN158368','IN158924','IN156800',
'IN158813','IN158827','IN157331','IN157882','IN158366','IN156504','IN156479','IN157265','IN157263','IN159272','IN156882',
'IN158374','IN158735','IN158798','IN154625','IN156073','IN156891','IN159152','IN158145','IN157728','IN159194','IN158376',
'IN158691','IN157264','IN159268','IN159236','IN159093','IN159464');

SELECT 'Total SaleItems in Batch 2:' AS Status, COUNT(*) AS Count FROM [dbo].[SaleItem] si
WHERE si.SaleId IN (SELECT Id FROM [dbo].[Sale] WHERE SaleNumber IN ('IN157235','IN157271','IN157272','IN157273','IN157323','IN157324','IN157325','IN157370','IN157480',
'IN157722','IN157723','IN157724','IN157794','IN157947','IN158030','IN158031','IN158032','IN158062','IN158065','IN158151',
'IN158153','IN158157','IN158159','IN158226','IN158227','IN158235','IN158237','IN158238','IN158239','IN158240','IN158241',
'IN158242','IN158243','IN158244','IN158251','IN158451','IN158928','IN159310','IN159311','IN159312','IN159314','IN159315',
'IN159317','IN159319','IN159320','IN159323','IN159324','IN159326','IN159327','IN159329','IN159465','CN103214','IN159555',
'IN157328','IN154160','IN156572','IN157895','IN157897','IN156936','IN152428','IN153152','IN153185','IN156476','IN156530',
'IN156531','IN156845','IN157919','IN157920','IN157923','IN157924','IN157925','IN157927','IN157929','IN157933','IN158371',
'IN158572','IN158654','IN153718','IN158144','IN157482','IN156532','IN155219','IN156529','IN156846','IN156533','IN156844',
'IN156443','IN157932','IN156500','IN156934','IN153141','IN155213','IN156576','IN157873','IN155982','IN157868','IN156585',
'IN157887','IN156786','IN155928','IN157867','IN158250','IN155222','IN156579','IN157871','IN158881','IN159233','IN158882',
'IN155215','IN157360','IN155212','IN156787','IN157876','IN158370','IN155216','IN156573','IN156586','CN103079','CN103080',
'IN156729','IN156950','IN157262','IN155218','IN156582','IN157872','IN156581','IN156804','IN156843','IN156977','IN154817',
'IN155211','IN156501','IN156987','IN158880','IN158578','IN158879','IN156802','IN157890','IN158368','IN158924','IN156800',
'IN158813','IN158827','IN157331','IN157882','IN158366','IN156504','IN156479','IN157265','IN157263','IN159272','IN156882',
'IN158374','IN158735','IN158798','IN154625','IN156073','IN156891','IN159152','IN158145','IN157728','IN159194','IN158376',
'IN158691','IN157264','IN159268','IN159236','IN159093','IN159464'));

-- Grand Total Value
SELECT 'Grand Total Value (Batch 2):' AS Status, SUM(Total) AS TotalValue FROM [dbo].[Sale]
WHERE SaleNumber IN ('IN157235','IN157271','IN157272','IN157273','IN157323','IN157324','IN157325','IN157370','IN157480',
'IN157722','IN157723','IN157724','IN157794','IN157947','IN158030','IN158031','IN158032','IN158062','IN158065','IN158151',
'IN158153','IN158157','IN158159','IN158226','IN158227','IN158235','IN158237','IN158238','IN158239','IN158240','IN158241',
'IN158242','IN158243','IN158244','IN158251','IN158451','IN158928','IN159310','IN159311','IN159312','IN159314','IN159315',
'IN159317','IN159319','IN159320','IN159323','IN159324','IN159326','IN159327','IN159329','IN159465','CN103214','IN159555',
'IN157328','IN154160','IN156572','IN157895','IN157897','IN156936','IN152428','IN153152','IN153185','IN156476','IN156530',
'IN156531','IN156845','IN157919','IN157920','IN157923','IN157924','IN157925','IN157927','IN157929','IN157933','IN158371',
'IN158572','IN158654','IN153718','IN158144','IN157482','IN156532','IN155219','IN156529','IN156846','IN156533','IN156844',
'IN156443','IN157932','IN156500','IN156934','IN153141','IN155213','IN156576','IN157873','IN155982','IN157868','IN156585',
'IN157887','IN156786','IN155928','IN157867','IN158250','IN155222','IN156579','IN157871','IN158881','IN159233','IN158882',
'IN155215','IN157360','IN155212','IN156787','IN157876','IN158370','IN155216','IN156573','IN156586','CN103079','CN103080',
'IN156729','IN156950','IN157262','IN155218','IN156582','IN157872','IN156581','IN156804','IN156843','IN156977','IN154817',
'IN155211','IN156501','IN156987','IN158880','IN158578','IN158879','IN156802','IN157890','IN158368','IN158924','IN156800',
'IN158813','IN158827','IN157331','IN157882','IN158366','IN156504','IN156479','IN157265','IN157263','IN159272','IN156882',
'IN158374','IN158735','IN158798','IN154625','IN156073','IN156891','IN159152','IN158145','IN157728','IN159194','IN158376',
'IN158691','IN157264','IN159268','IN159236','IN159093','IN159464');
